!function(_,S){"object"==typeof exports&&"object"==typeof module?module.exports=S(require("ionic.angular"),require("ionic.storage"),require("ng.common"),require("ng.core"),require("ng.forms"),require("ngx-translate.core"),require("rxjs"),require("tslib"),require("wako-app.mobile-sdk")):"function"==typeof define&&define.amd?define(["ionic.angular","ionic.storage","ng.common","ng.core","ng.forms","ngx-translate.core","rxjs","tslib","wako-app.mobile-sdk"],S):"object"==typeof exports?exports.plugin=S(require("ionic.angular"),require("ionic.storage"),require("ng.common"),require("ng.core"),require("ng.forms"),require("ngx-translate.core"),require("rxjs"),require("tslib"),require("wako-app.mobile-sdk")):_.plugin=S(_["ionic.angular"],_["ionic.storage"],_["ng.common"],_["ng.core"],_["ng.forms"],_["ngx-translate.core"],_.rxjs,_.tslib,_["wako-app.mobile-sdk"])}(typeof self<"u"?self:this,(L,_,S,ce,ue,de,pe,me,fe)=>(()=>{"use strict";var he={372:a=>{a.exports=L},278:a=>{a.exports=_},223:a=>{a.exports=S},888:a=>{a.exports=ce},951:a=>{a.exports=ue},584:a=>{a.exports=de},832:a=>{a.exports=pe},748:a=>{a.exports=me},95:a=>{a.exports=fe}},V={};function p(a){var u=V[a];if(void 0!==u)return u.exports;var l=V[a]={exports:{}};return he[a](l,l.exports,p),l.exports}p.d=(a,u)=>{for(var l in u)p.o(u,l)&&!p.o(a,l)&&Object.defineProperty(a,l,{enumerable:!0,get:u[l]})},p.o=(a,u)=>Object.prototype.hasOwnProperty.call(a,u),p.r=a=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})};var T={};return(()=>{p.r(T),p.d(T,{PluginModule:()=>le,default:()=>et});var z,a=p(223),u=p(951),l=p(372),f=p(748),o=p(888),O=p(278);const N=new o.InjectionToken("STORAGE_CONFIG_TOKEN");class _e extends O.Storage{constructor(){super()}create(){return(0,f.__awaiter)(this,void 0,void 0,function*(){return this})}defineDriver(){return(0,f.__awaiter)(this,void 0,void 0,function*(){})}get driver(){return"noop"}get(n){return(0,f.__awaiter)(this,void 0,void 0,function*(){return null})}set(n,e){return(0,f.__awaiter)(this,void 0,void 0,function*(){})}remove(n){return(0,f.__awaiter)(this,void 0,void 0,function*(){})}clear(){return(0,f.__awaiter)(this,void 0,void 0,function*(){})}length(){return(0,f.__awaiter)(this,void 0,void 0,function*(){return 0})}keys(){return(0,f.__awaiter)(this,void 0,void 0,function*(){return[]})}forEach(n){return(0,f.__awaiter)(this,void 0,void 0,function*(){})}setEncryptionKey(n){}}function ge(t){return(0,a.isPlatformServer)(this.platformId)?new _e:new O.Storage(t)}let C=z=class{static forRoot(n=null){return{ngModule:z,providers:[{provide:N,useValue:n},{provide:O.Storage,useFactory:ge,deps:[N]}]}}};C.\u0275fac=function(n){return new(n||C)},C.\u0275mod=o.\u0275\u0275defineNgModule({type:C}),C.\u0275inj=o.\u0275\u0275defineInjector({});var M=p(584),h=p(95);function K(t,n,e,r,i,s,c){try{var d=t[s](c),g=d.value}catch(tt){return void e(tt)}d.done?n(g):Promise.resolve(g).then(r,i)}function F(t){return function(){var n=this,e=arguments;return new Promise(function(r,i){var s=t.apply(n,e);function c(g){K(s,r,i,c,d,"next",g)}function d(g){K(s,r,i,c,d,"throw",g)}c(void 0)})}}var k=p(832);function b(...t){(0,h.wakoLog)("plugin.my-plugin",t)}let I=(()=>{class t{constructor(e,r){this.toastCtrl=e,this.translateService=r}simpleMessage(e,r,i=2e3,s="top"){this.translateService.get(e,r).subscribe(c=>{this.toastCtrl.create({message:c,mode:"ios",position:s,duration:i}).then(d=>{d.present()})})}}return t.\u0275fac=function(e){return new(e||t)(o.\u0275\u0275inject(l.ToastController),o.\u0275\u0275inject(M.TranslateService))},t.\u0275prov=o.\u0275\u0275defineInjectable({token:t,factory:t.\u0275fac}),t})();function be(t,n){if(1&t){const e=o.\u0275\u0275getCurrentView();o.\u0275\u0275elementStart(0,"ion-card-content")(1,"ion-button",16),o.\u0275\u0275listener("click",function(){o.\u0275\u0275restoreView(e);const i=o.\u0275\u0275nextContext();return o.\u0275\u0275resetView(i.openImdb(i.movie.ids.imdb))}),o.\u0275\u0275text(2," Open on Imdb "),o.\u0275\u0275elementEnd()()}}function ve(t,n){if(1&t){const e=o.\u0275\u0275getCurrentView();o.\u0275\u0275elementStart(0,"ion-card-content")(1,"ion-button",16),o.\u0275\u0275listener("click",function(){o.\u0275\u0275restoreView(e);const i=o.\u0275\u0275nextContext();return o.\u0275\u0275resetView(i.openImdb(i.show.ids.imdb))}),o.\u0275\u0275text(2),o.\u0275\u0275pipe(3,"translate"),o.\u0275\u0275elementEnd()()}2&t&&(o.\u0275\u0275advance(2),o.\u0275\u0275textInterpolate1(" ",o.\u0275\u0275pipeBind1(3,1,"openImdb")," "))}let B=(()=>{class t{constructor(e,r,i,s){this.modalCtrl=e,this.toastService=r,this.storage=i,this.loadingController=s,this.formHost=new u.FormGroup({host:new u.FormControl("192.168.1.10"),port:new u.FormControl("8080"),login:new u.FormControl("kodi"),password:new u.FormControl("kodi")})}ngOnInit(){var e=this;return F(function*(){e.toastService.simpleMessage("openMedia",{imdbId:e.movie?e.movie.ids.imdb:e.show.ids.imdb});const r=yield e.storage.get("kodiSettings");r&&(e.formHost.setValue({host:r.host,port:r.port,login:r.login,password:r.password}),e.setCurrentHost())})()}dismiss(){this.modalCtrl.dismiss()}openImdb(e){h.BrowserService.open(`http://www.imdb.com/title/${e}/`)}saveHost(){this.storage.set("kodiSettings",{host:this.formHost.value.host,port:this.formHost.value.port,login:this.formHost.value.login,password:this.formHost.value.password}),this.setCurrentHost()}setCurrentHost(){h.KodiAppService.setCurrentHost({name:"WakoAddonStarterKit",host:this.formHost.value.host,port:+this.formHost.value.port,login:this.formHost.value.login,password:this.formHost.value.password,uuid:"WakoAddonStarterKit"})}openUrlOnKodi(e){var r=this;return F(function*(){const i=yield r.loadingController.create({cssClass:"my-custom-class",message:"Please wait...",backdropDismiss:!0});yield i.present(),h.KodiAppService.checkAndConnectToCurrentHost().pipe((0,k.catchError)((s,c)=>(i.dismiss(),b("Error on kodi",s),r.toastService.simpleMessage("hostUnreachable"===s?"My Addon: Your kodi host is unreachable":"My Addon: You must add a kodi host"),k.NEVER))).subscribe(()=>{h.KodiAppService.openUrl(e).pipe((0,k.finalize)(()=>i.dismiss())).subscribe({next:()=>{r.toastService.simpleMessage("URL opened")},error:()=>{r.toastService.simpleMessage("Failed to open URL, check Kodi connection first")}})})})()}}return t.\u0275fac=function(e){return new(e||t)(o.\u0275\u0275directiveInject(l.ModalController),o.\u0275\u0275directiveInject(I),o.\u0275\u0275directiveInject(h.WakoStorage),o.\u0275\u0275directiveInject(l.LoadingController))},t.\u0275cmp=o.\u0275\u0275defineComponent({type:t,selectors:[["app-media-modal"]],decls:42,vars:5,consts:[["slot","end"],["color","light",3,"click"],["name","close"],[4,"ngIf"],[3,"formGroup","ngSubmit"],["position","floating"],["type","text","name","host","formControlName","host","required",""],["type","number","name","port","formControlName","port","required",""],["type","text","name","login","formControlName","login"],["type","password","name","password","formControlName","password"],["expand","block","block","","type","submit",3,"disabled"],["slot","start","name","save-outline"],["value","https://archive.org/download/BigBuckBunny_328/BigBuckBunny_512kb.mp4","type","text","required",""],["urlInput",""],["expand","block","block","","type","submit",3,"click"],["slot","start "],[3,"click"]],template:function(e,r){if(1&e){const i=o.\u0275\u0275getCurrentView();o.\u0275\u0275elementStart(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),o.\u0275\u0275text(3),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(4,"ion-buttons",0)(5,"ion-button",1),o.\u0275\u0275listener("click",function(){return r.dismiss()}),o.\u0275\u0275element(6,"ion-icon",2),o.\u0275\u0275elementEnd()()()(),o.\u0275\u0275elementStart(7,"ion-content")(8,"ion-card"),o.\u0275\u0275template(9,be,3,0,"ion-card-content",3),o.\u0275\u0275template(10,ve,4,3,"ion-card-content",3),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(11,"ion-card")(12,"ion-card-content")(13,"form",4),o.\u0275\u0275listener("ngSubmit",function(){return r.saveHost()}),o.\u0275\u0275elementStart(14,"ion-item")(15,"ion-label",5),o.\u0275\u0275text(16,"Host"),o.\u0275\u0275elementEnd(),o.\u0275\u0275element(17,"ion-input",6),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(18,"ion-item")(19,"ion-label",5),o.\u0275\u0275text(20,"Port"),o.\u0275\u0275elementEnd(),o.\u0275\u0275element(21,"ion-input",7),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(22,"ion-item")(23,"ion-label",5),o.\u0275\u0275text(24,"Login"),o.\u0275\u0275elementEnd(),o.\u0275\u0275element(25,"ion-input",8),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(26,"ion-item")(27,"ion-label",5),o.\u0275\u0275text(28,"Password"),o.\u0275\u0275elementEnd(),o.\u0275\u0275element(29,"ion-input",9),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(30,"ion-button",10),o.\u0275\u0275element(31,"ion-icon",11),o.\u0275\u0275text(32," Save Host "),o.\u0275\u0275elementEnd()()()(),o.\u0275\u0275elementStart(33,"ion-card")(34,"ion-item")(35,"ion-label",5),o.\u0275\u0275text(36,"Url"),o.\u0275\u0275elementEnd(),o.\u0275\u0275element(37,"ion-input",12,13),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(39,"ion-button",14),o.\u0275\u0275listener("click",function(){o.\u0275\u0275restoreView(i);const c=o.\u0275\u0275reference(38);return o.\u0275\u0275resetView(r.openUrlOnKodi(c.value))}),o.\u0275\u0275element(40,"ion-icon",15),o.\u0275\u0275text(41," Open Url On Kodi "),o.\u0275\u0275elementEnd()()()}2&e&&(o.\u0275\u0275advance(3),o.\u0275\u0275textInterpolate1(" V3 ",r.movie?r.movie.title:r.show.title+" "+r.episode.code," "),o.\u0275\u0275advance(6),o.\u0275\u0275property("ngIf",r.movie),o.\u0275\u0275advance(1),o.\u0275\u0275property("ngIf",r.show),o.\u0275\u0275advance(3),o.\u0275\u0275property("formGroup",r.formHost),o.\u0275\u0275advance(17),o.\u0275\u0275property("disabled",!r.formHost.valid))},dependencies:[a.NgIf,u.\u0275NgNoValidate,u.NgControlStatus,u.NgControlStatusGroup,u.RequiredValidator,u.FormGroupDirective,u.FormControlName,l.IonButton,l.IonButtons,l.IonCard,l.IonCardContent,l.IonContent,l.IonHeader,l.IonIcon,l.IonInput,l.IonItem,l.IonLabel,l.IonToolbar,l.IonTitle,l.NumericValueAccessor,l.TextValueAccessor,M.TranslatePipe]}),t})(),G=(()=>{class t extends h.EpisodeDetailBaseComponent{constructor(e){super(),this.modalCtrl=e}setShowEpisode(e,r){this.show=e,this.episode=r}openEpisode(){this.modalCtrl.create({component:B,componentProps:{show:this.show,episode:this.episode}}).then(e=>{e.present()})}}return t.\u0275fac=function(e){return new(e||t)(o.\u0275\u0275directiveInject(l.ModalController))},t.\u0275cmp=o.\u0275\u0275defineComponent({type:t,selectors:[["ng-component"]],features:[o.\u0275\u0275InheritDefinitionFeature],decls:2,vars:2,consts:[["expand","block","color","custom",3,"click"]],template:function(e,r){1&e&&(o.\u0275\u0275elementStart(0,"ion-button",0),o.\u0275\u0275listener("click",function(){return r.openEpisode()}),o.\u0275\u0275text(1),o.\u0275\u0275elementEnd()),2&e&&(o.\u0275\u0275advance(1),o.\u0275\u0275textInterpolate2(" Show : ",r.show.title," - Episode ",r.episode.code," "))},dependencies:[l.IonButton],styles:["ion-button[_ngcontent-%COMP%]{background-color:#d26a1f!important;border-radius:5px}"]}),t})(),Y=(()=>{class t extends h.EpisodeDetailBaseComponent{constructor(e){super(),this.toastService=e}setShowEpisode(e,r){this.show=e,this.episode=r}openEpisode(){this.toastService.simpleMessage("Click on episode: "+this.episode.title)}}return t.\u0275fac=function(e){return new(e||t)(o.\u0275\u0275directiveInject(I))},t.\u0275cmp=o.\u0275\u0275defineComponent({type:t,selectors:[["ng-component"]],features:[o.\u0275\u0275InheritDefinitionFeature],decls:4,vars:0,consts:[[1,"ion-item-options"],[3,"click"],[1,"ion-item-detail"],["name","beer-outline"]],template:function(e,r){1&e&&(o.\u0275\u0275elementStart(0,"div",0)(1,"ion-item-option",1),o.\u0275\u0275listener("click",function(){return r.openEpisode()}),o.\u0275\u0275elementStart(2,"div",2),o.\u0275\u0275element(3,"ion-icon",3),o.\u0275\u0275elementEnd()()())},dependencies:[l.IonIcon,l.IonItemOption],styles:["ion-button[_ngcontent-%COMP%]{background-color:#d26a1f!important;border-radius:5px}.ion-item-options[_ngcontent-%COMP%]{display:flex;height:100%}.ion-item-options[_ngcontent-%COMP%]   .ion-item-detail[_ngcontent-%COMP%]{width:60px;display:grid;text-align:center}.ion-item-options[_ngcontent-%COMP%]   .ion-item-detail[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:2em;width:100%}.ion-item-options[_ngcontent-%COMP%]   .ion-item-detail[_ngcontent-%COMP%]   ion-text[_ngcontent-%COMP%]{margin-top:3px;font-size:8px;text-transform:none}"]}),t})(),$=(()=>{class t extends h.MovieDetailBaseComponent{constructor(e){super(),this.modalCtrl=e}setMovie(e){this.movie=e}openMovie(){this.modalCtrl.create({component:B,componentProps:{movie:this.movie}}).then(e=>{e.present()})}}return t.\u0275fac=function(e){return new(e||t)(o.\u0275\u0275directiveInject(l.ModalController))},t.\u0275cmp=o.\u0275\u0275defineComponent({type:t,selectors:[["ng-component"]],features:[o.\u0275\u0275InheritDefinitionFeature],decls:2,vars:1,consts:[["expand","block","color","custom",3,"click"]],template:function(e,r){1&e&&(o.\u0275\u0275elementStart(0,"ion-button",0),o.\u0275\u0275listener("click",function(){return r.openMovie()}),o.\u0275\u0275text(1),o.\u0275\u0275elementEnd()),2&e&&(o.\u0275\u0275advance(1),o.\u0275\u0275textInterpolate1(" My movie : ",r.movie.title,""))},dependencies:[l.IonButton],styles:["ion-button[_ngcontent-%COMP%]{background-color:#d24f92!important;border-radius:5px}"]}),t})(),W=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=o.\u0275\u0275defineComponent({type:t,selectors:[["app-plugin-detail"]],features:[o.\u0275\u0275ProvidersFeature([a.UpperCasePipe])],decls:3,vars:3,template:function(e,r){1&e&&(o.\u0275\u0275elementStart(0,"p"),o.\u0275\u0275text(1),o.\u0275\u0275pipe(2,"uppercase"),o.\u0275\u0275elementEnd()),2&e&&(o.\u0275\u0275advance(1),o.\u0275\u0275textInterpolate1(" ",o.\u0275\u0275pipeBind1(2,1,"This is the plugin detail"),"\n"))},dependencies:[a.UpperCasePipe]}),t})(),J=(()=>{class t extends h.PluginBaseService{constructor(e){super(),this.translate=e}fetchExplorerFolderItem(){throw new Error("Method not implemented.")}getFileActionButtons(e,r,i,s,c,d){throw new Error("Method not implemented.")}initialize(){b("plugin initialized");const e=document.createElement("style");e.innerHTML="\n      .rating-container {\n        background-color: grey\n      }\n    ",document.body.append(e)}afterInstall(){b("plugin installed")}afterUpdate(){b("plugin updated")}setTranslation(e,r){this.translate.setDefaultLang(e),this.translate.use(e),this.translate.setTranslation(e,r)}customAction(e,r){}beforeMovieMiddleware(e){return e.ratings.imdb&&(e.ratings.imdb.imageUrl="https://eu.simkl.in/img_tv/ico-rating_imdb.png?v2"),Promise.resolve(e)}afterMovieMiddleware(e){return new Promise(r=>{setTimeout(()=>{e.ratings.myMovieRating||(e.ratings.myMovieRating={name:"myMovieRating",url:"https://trakt.tv/assets/logos/header@2x-09f929ba67b0964596b359f497884cd9.png",rating:1,votes:123},r(e))},3e3)})}beforeShowMiddleware(e){return e.ratings.imdb&&(e.ratings.imdb.imageUrl="https://eu.simkl.in/img_tv/ico_rating_simkl.png"),Promise.resolve(e)}afterShowMiddleware(e){return new Promise(r=>{setTimeout(()=>{e.ratings.myShowRating||(e.ratings.myShowRating={name:"myShowRating",url:"https://trakt.tv/assets/logos/header@2x-09f929ba67b0964596b359f497884cd9.png",rating:3,votes:456},r(e))},3e3)})}beforeEpisodeMiddleware(e,r){return r.ratings.imdb&&(r.ratings.imdb.imageUrl="https://www.rottentomatoes.com/assets/pizza-pie/images/icons/tomatometer/tomatometer-fresh.149b5e8adc3.svg"),Promise.resolve(r)}afterEpisodeMiddleware(e,r){return"anime"===e.type&&(r.imagesUrl.poster="https://simkl.in/posters/10/10361285fce228d8a_m.webp"),Promise.resolve(r)}}return t.\u0275fac=function(e){return new(e||t)(o.\u0275\u0275inject(M.TranslateService))},t.\u0275prov=o.\u0275\u0275defineInjectable({token:t,factory:t.\u0275fac}),t})(),Q=(()=>{class t{constructor(e){this.translate=e}ngOnInit(){b("Current lang",this.translate.currentLang),b("Test instant translate",this.translate.instant("settings.title"))}}return t.\u0275fac=function(e){return new(e||t)(o.\u0275\u0275directiveInject(M.TranslateService))},t.\u0275cmp=o.\u0275\u0275defineComponent({type:t,selectors:[["ng-component"]],decls:5,vars:3,template:function(e,r){1&e&&(o.\u0275\u0275elementStart(0,"p"),o.\u0275\u0275text(1),o.\u0275\u0275pipe(2,"translate"),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(3,"p"),o.\u0275\u0275text(4,"My plugin"),o.\u0275\u0275elementEnd()),2&e&&(o.\u0275\u0275advance(1),o.\u0275\u0275textInterpolate1(" ",o.\u0275\u0275pipeBind1(2,1,"settings.title"),"\n"))},dependencies:[M.TranslatePipe]}),t})();function m(t){return"function"==typeof t}const A=function Se(t){const e=t(r=>{Error.call(r),r.stack=(new Error).stack});return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}(t=>function(e){t(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((r,i)=>`${i+1}) ${r.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e});function X(t,n){if(t){const e=t.indexOf(n);0<=e&&t.splice(e,1)}}class v{constructor(n){this.initialTeardown=n,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let n;if(!this.closed){this.closed=!0;const{_parentage:e}=this;if(e)if(this._parentage=null,Array.isArray(e))for(const s of e)s.remove(this);else e.remove(this);const{initialTeardown:r}=this;if(m(r))try{r()}catch(s){n=s instanceof A?s.errors:[s]}const{_finalizers:i}=this;if(i){this._finalizers=null;for(const s of i)try{ee(s)}catch(c){n=n??[],c instanceof A?n=[...n,...c.errors]:n.push(c)}}if(n)throw new A(n)}}add(n){var e;if(n&&n!==this)if(this.closed)ee(n);else{if(n instanceof v){if(n.closed||n._hasParent(this))return;n._addParent(this)}(this._finalizers=null!==(e=this._finalizers)&&void 0!==e?e:[]).push(n)}}_hasParent(n){const{_parentage:e}=this;return e===n||Array.isArray(e)&&e.includes(n)}_addParent(n){const{_parentage:e}=this;this._parentage=Array.isArray(e)?(e.push(n),e):e?[e,n]:n}_removeParent(n){const{_parentage:e}=this;e===n?this._parentage=null:Array.isArray(e)&&X(e,n)}remove(n){const{_finalizers:e}=this;e&&X(e,n),n instanceof v&&n._removeParent(this)}}function Z(t){return t instanceof v||t&&"closed"in t&&m(t.remove)&&m(t.add)&&m(t.unsubscribe)}function ee(t){m(t)?t():t.unsubscribe()}v.EMPTY=(()=>{const t=new v;return t.closed=!0,t})();const y={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},E={setTimeout(t,n,...e){const{delegate:r}=E;return r?.setTimeout?r.setTimeout(t,n,...e):setTimeout(t,n,...e)},clearTimeout(t){const{delegate:n}=E;return(n?.clearTimeout||clearTimeout)(t)},delegate:void 0};function te(t){E.setTimeout(()=>{const{onUnhandledError:n}=y;if(!n)throw t;n(t)})}function ne(){}const Ce=U("C",void 0,void 0);function U(t,n,e){return{kind:t,value:n,error:e}}let w=null;class j extends v{constructor(n){super(),this.isStopped=!1,n?(this.destination=n,Z(n)&&n.add(this)):this.destination=Oe}static create(n,e,r){return new H(n,e,r)}next(n){this.isStopped?D(function xe(t){return U("N",t,void 0)}(n),this):this._next(n)}error(n){this.isStopped?D(function Me(t){return U("E",void 0,t)}(n),this):(this.isStopped=!0,this._error(n))}complete(){this.isStopped?D(Ce,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(n){this.destination.next(n)}_error(n){try{this.destination.error(n)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const Ee=Function.prototype.bind;function R(t,n){return Ee.call(t,n)}class Pe{constructor(n){this.partialObserver=n}next(n){const{partialObserver:e}=this;if(e.next)try{e.next(n)}catch(r){P(r)}}error(n){const{partialObserver:e}=this;if(e.error)try{e.error(n)}catch(r){P(r)}else P(n)}complete(){const{partialObserver:n}=this;if(n.complete)try{n.complete()}catch(e){P(e)}}}class H extends j{constructor(n,e,r){let i;if(super(),m(n)||!n)i={next:n??void 0,error:e??void 0,complete:r??void 0};else{let s;this&&y.useDeprecatedNextContext?(s=Object.create(n),s.unsubscribe=()=>this.unsubscribe(),i={next:n.next&&R(n.next,s),error:n.error&&R(n.error,s),complete:n.complete&&R(n.complete,s)}):i=n}this.destination=new Pe(i)}}function P(t){y.useDeprecatedSynchronousErrorHandling?function Ie(t){y.useDeprecatedSynchronousErrorHandling&&w&&(w.errorThrown=!0,w.error=t)}(t):te(t)}function D(t,n){const{onStoppedNotification:e}=y;e&&E.setTimeout(()=>e(t,n))}const Oe={closed:!0,next:ne,error:function Te(t){throw t},complete:ne},q="function"==typeof Symbol&&Symbol.observable||"@@observable";function Fe(t){return t}let x=(()=>{class t{constructor(e){e&&(this._subscribe=e)}lift(e){const r=new t;return r.source=this,r.operator=e,r}subscribe(e,r,i){const s=function Ae(t){return t&&t instanceof j||function Be(t){return t&&m(t.next)&&m(t.error)&&m(t.complete)}(t)&&Z(t)}(e)?e:new H(e,r,i);return function ke(t){if(y.useDeprecatedSynchronousErrorHandling){const n=!w;if(n&&(w={errorThrown:!1,error:null}),t(),n){const{errorThrown:e,error:r}=w;if(w=null,e)throw r}}else t()}(()=>{const{operator:c,source:d}=this;s.add(c?c.call(s,d):d?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(e){try{return this._subscribe(e)}catch(r){e.error(r)}}forEach(e,r){return new(r=re(r))((i,s)=>{const c=new H({next:d=>{try{e(d)}catch(g){s(g),c.unsubscribe()}},error:s,complete:i});this.subscribe(c)})}_subscribe(e){var r;return null===(r=this.source)||void 0===r?void 0:r.subscribe(e)}[q](){return this}pipe(...e){return function oe(t){return 0===t.length?Fe:1===t.length?t[0]:function(e){return t.reduce((r,i)=>i(r),e)}}(e)(this)}toPromise(e){return new(e=re(e))((r,i)=>{let s;this.subscribe(c=>s=c,c=>i(c),()=>r(s))})}}return t.create=n=>new t(n),t})();function re(t){var n;return null!==(n=t??y.Promise)&&void 0!==n?n:Promise}const De=function He(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function ie(t){return new x(n=>{(function We(t,n){var e,r,i,s;return(0,f.__awaiter)(this,void 0,void 0,function*(){try{for(e=(0,f.__asyncValues)(t);!(r=yield e.next()).done;)if(n.next(r.value),n.closed)return}catch(c){i={error:c}}finally{try{r&&!r.done&&(s=e.return)&&(yield s.call(e))}finally{if(i)throw i.error}}n.complete()})})(t,n).catch(e=>n.error(e))})}class Qe extends j{constructor(n,e,r,i,s,c){super(n),this.onFinalize=s,this.shouldUnsubscribe=c,this._next=e?function(d){try{e(d)}catch(g){n.error(g)}}:super._next,this._error=i?function(d){try{i(d)}catch(g){n.error(g)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(d){n.error(d)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:e}=this;super.unsubscribe(),!e&&(null===(n=this.onFinalize)||void 0===n||n.call(this))}}}function se(t){return function Ze(t){return n=>{if(function Xe(t){return m(t?.lift)}(n))return n.lift(function(e){try{return t(e,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}((n,e)=>{let s,r=null,i=!1;r=n.subscribe(function Je(t,n,e,r,i){return new Qe(t,n,e,r,i)}(e,void 0,void 0,c=>{s=function ze(t){if(t instanceof x)return t;if(null!=t){if(function Ue(t){return m(t[q])}(t))return function Ne(t){return new x(n=>{const e=t[q]();if(m(e.subscribe))return e.subscribe(n);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(t);if((t=>t&&"number"==typeof t.length&&"function"!=typeof t)(t))return function Ke(t){return new x(n=>{for(let e=0;e<t.length&&!n.closed;e++)n.next(t[e]);n.complete()})}(t);if(function we(t){return m(t?.then)}(t))return function Ge(t){return new x(n=>{t.then(e=>{n.closed||(n.next(e),n.complete())},e=>n.error(e)).then(null,te)})}(t);if(function je(t){return Symbol.asyncIterator&&m(t?.[Symbol.asyncIterator])}(t))return ie(t);if(function qe(t){return m(t?.[De])}(t))return function Ye(t){return new x(n=>{for(const e of t)if(n.next(e),n.closed)return;n.complete()})}(t);if(function Ve(t){return m(t?.getReader)}(t))return function $e(t){return ie(function Le(t){return(0,f.__asyncGenerator)(this,arguments,function*(){const e=t.getReader();try{for(;;){const{value:r,done:i}=yield(0,f.__await)(e.read());if(i)return yield(0,f.__await)(void 0);yield yield(0,f.__await)(r)}}finally{e.releaseLock()}})}(t))}(t)}throw function Re(t){return new TypeError(`You provided ${null!==t&&"object"==typeof t?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}(t)}(t(c,se(t)(n))),r?(r.unsubscribe(),r=null,s.subscribe(e)):i=!0})),i&&(r.unsubscribe(),r=null,s.subscribe(e))})}let ae=(()=>{class t extends h.ShowDetailBaseComponent{constructor(e,r){super(),this.toastService=e,this.loadingController=r}setShow(e){this.show=e}clickShow(){var e=this;return F(function*(){const r=yield e.loadingController.create({cssClass:"my-custom-class",message:"Please wait...",backdropDismiss:!0});yield r.present(),h.KodiAppService.checkAndConnectToCurrentHost().pipe(se((i,s)=>(r.dismiss(),b("Error on kodi",i),e.toastService.simpleMessage("hostUnreachable"===i?"My Addon: Your kodi host is unreachable":"My Addon: You must add a kodi host"),k.NEVER))).subscribe(()=>{if(!e.show.trailer)return r.dismiss(),void e.toastService.simpleMessage("My Addon: No trailer available");const s=`plugin://plugin.video.youtube/?action=play_video&videoid=${new URLSearchParams(e.show.trailer.split("?")[1]).get("v")}`;b("Opening URL",s),h.KodiAppService.openUrl(s).pipe((0,k.finalize)(()=>r.dismiss())).subscribe({next:()=>{e.toastService.simpleMessage("URL opened")},error:()=>{e.toastService.simpleMessage("Failed to open URL, check Kodi connection first")}})})})()}}return t.\u0275fac=function(e){return new(e||t)(o.\u0275\u0275directiveInject(I),o.\u0275\u0275directiveInject(l.LoadingController))},t.\u0275cmp=o.\u0275\u0275defineComponent({type:t,selectors:[["ng-component"]],features:[o.\u0275\u0275InheritDefinitionFeature],decls:2,vars:0,consts:[["expand","block","color","custom",3,"click"]],template:function(e,r){1&e&&(o.\u0275\u0275elementStart(0,"ion-button",0),o.\u0275\u0275listener("click",function(){return r.clickShow()}),o.\u0275\u0275text(1," Open trailer on kodi\n"),o.\u0275\u0275elementEnd())},dependencies:[l.IonButton],styles:["ion-button[_ngcontent-%COMP%]{background-color:#d20012!important;border-radius:5px}"]}),t})(),le=(()=>{class t extends h.PluginBaseModule{}return t.pluginService=J,t.settingsComponent=Q,t.movieComponent=$,t.episodeComponent=G,t.episodeItemOptionComponent=Y,t.showComponent=ae,t.pluginDetailComponent=W,t.\u0275fac=function(){let n;return function(r){return(n||(n=o.\u0275\u0275getInheritedFactory(t)))(r||t)}}(),t.\u0275mod=o.\u0275\u0275defineNgModule({type:t}),t.\u0275inj=o.\u0275\u0275defineInjector({providers:[J,I,...h.WakoProviders],imports:[a.CommonModule,u.FormsModule,u.ReactiveFormsModule,l.IonicModule.forRoot(),M.TranslateModule.forRoot(),C.forRoot({name:"wako"})]}),t})();const et=le})(),T})());